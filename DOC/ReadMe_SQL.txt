Source
******
Public (доступ без УЗ)
host = https://rp5.ru/rss/5483/ru

XML-строка, исходные данные метеодатчиков
==========
Поля
----
https://ru.wikipedia.org/wiki/XPath
/feed/title - текст
название локации

/feed/updated - текст, приводится к timestamptz(0)
время обновления данных

/feed/entry/summary/span[@class="t_0"] - текст, некоторые значения приводятся к numeric(4,1), неприводимые значения нужно отбросить.
температуры отдельных датчиков, средняя температура (не доверяем, читаем всё и усредняем) и единицы измерения

далее
БД PostgreSQL
host=localhost:15432
УЗ=jovyan/jovyan

Stage
*****

rp5 таблица, исходные данные метеодатчиков. Очищается каждый раз перед добавлением данных.
===========
id serial4 NOT NULL rp5_pkey PRIMARY KEY
суррагатный ключ

region varchar(100) NULL
локация метеодатчиков

dt varchar(25) NULL
время сбора данных

t varchar(10) NULL
зафиксированная температура

DDS
***

regions таблица, все используемые локации
===============
id serial4 NOT NULL PRIMARY KEY
суррагатный ключ

region varchar(100) NOT NULL
название локации


temp таблица, зафиксированные температуры, очищено от нечисловых значений. Удаляются данные старше 1 недели
============
id serial4 NOT NULL PRIMARY KEY 
суррагатный ключ

region_id int4 NOT NULL
id локации, внешний ключ на dds.regions

dt timestamptz(0) NOT NULL
время фиксации температуры, приведено к timestamptz(0) и построен индекс для выполнения группировок

t numeric(4, 1) NOT NULL
зафиксированная температура


MART
****
regions таблица, все используемые локации. Полностью перегружается данными DDS.regions
===============
id serial4 NOT NULL PRIMARY KEY
суррагатный ключ

region varchar(100) NOT NULL
название локации


avg_temp таблица, усредненная температура, полученная за час в данной локации. Полностью пересчитывается из dds.temp 
================
id serial4 NOT NULL PRIMARY KEY 
суррагатный ключ

region_id int4 NOT NULL
id локации, внешний ключ на mart.regions

dt timestamptz(0) NOT NULL
время фиксации температуры без минут-секунд и построен индекс для выполнения поиска

t numeric(4, 1) NOT NULL
усредненная температура

ml_data представление, исторические данные температу. Для визуализации и построения прогноза. Строится на основе mart.regions и mart.avg_temp
=====================
region varchar
наименование локации

dt_max timestamptz(0)
время последнего замера без минту-секунд для данной локации

m0 - 0/1
признак зимнего месяца

m1 - 0/1
признак весеннего месяца

m2 - 0/1
признак летнего месяца

m3 - 0/1
признак осеннего месяца

hh - int
час 9 часов до dt_max 

t3 - float
температура в час hh

t2 - float
температура в час hh+3ч

t1 - float
температура в час hh+6ч

t0 - float
температура в час dt_max (он же hh+9ч)


data_share_history.txt файл, температура за последний час и три предыдущих усредненных показания с интервалом 3ч
===========================
1 строка  : наименование локации
2-5 строки: дата (в формате ГГГГ-ММ-ДД ЧЧ:00) и температура (градусы Цельсия)


data_share_future.txt файл, 4 прогноза температура с интервалом 3ч
==========================
1 строка  : наименование локации
2-5 строки: дата (в формате ГГГГ-ММ-ДД ЧЧ:00) и температура (градусы Цельсия)















